{"remainingRequest":"/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/node_modules/babel-loader/lib/index.js!/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/src/pages/myCart/components/CartDetails.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/src/pages/myCart/components/CartDetails.vue","mtime":1663917139985},{"path":"/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/babel.config.js","mtime":1658634198971},{"path":"/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/node_modules/cache-loader/dist/cjs.js","mtime":1663066735138},{"path":"/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/node_modules/babel-loader/lib/index.js","mtime":1663066738371},{"path":"/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/node_modules/cache-loader/dist/cjs.js","mtime":1663066735138},{"path":"/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/node_modules/vue-loader-v16/dist/index.js","mtime":1663066738351}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgeyBkZWNsYXJlVHlwZUFsaWFzIH0gZnJvbSAnQGJhYmVsL3R5cGVzJzsKaW1wb3J0IHsgb25Nb3VudGVkLCByZWFjdGl2ZSwgdG9SZWZzLCBjb21wdXRlZCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgQ291cnNlQWRkIGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvQ291cnNlQWRkLnZ1ZSc7CmltcG9ydCBlbWl0dGVyIGZyb20gJy4uLy4uLy4uL2NvbW1vbi9qcy9ldmVudGJ1cy5qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBDb3Vyc2VBZGQKICB9LAogIHByb3BzOiBbJ2NoYW5nZVNob3cnXSwKCiAgc2V0dXAocHJvcHMpIHsKICAgIGNvbnN0IHN0b3JlID0gdXNlU3RvcmUoKTsKICAgIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpOwogICAgbGV0IGRhdGEgPSByZWFjdGl2ZSh7CiAgICAgIHJlc3VsdDogW10sCiAgICAgIGNoZWNrZWQ6IHRydWUsCiAgICAgIGlzRGVsZXRlOiB0cnVlCiAgICB9KTsgLy9nb29kcyBkZWZhdWx0IHNlbGVjdGlvbiBpbml0aWFsaXphdGlvbgoKICAgIGNvbnN0IGluaXQgPSAoKSA9PiB7CiAgICAgIGRhdGEucmVzdWx0ID0gc3RvcmUuc3RhdGUuY2FydExpc3QubWFwKGl0ZW0gPT4gaXRlbS5pZCk7CiAgICB9OwoKICAgIG9uTW91bnRlZCgoKSA9PiB7CiAgICAgIGluaXQoKTsKICAgIH0pOyAvL2dvb2RzIG51bWJlciBzeWNjaHJvbml6YXRpb24KCiAgICBjb25zdCBvbkNoYW5nZSA9ICh2YWx1ZSwgZGV0YWlsKSA9PiB7CiAgICAgIHN0b3JlLnN0YXRlLmNhcnRMaXN0Lm1hcChpdGVtID0+IHsKICAgICAgICBpZiAoaXRlbS5pZCA9PT0gZGV0YWlsLm5hbWUpIHsKICAgICAgICAgIGl0ZW0ubnVtID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07IC8vc2VsZWN0IGFsbCBhbmQgdW5zZWxlY3QgYWxsCgoKICAgIGNvbnN0IGNob3NlQWxsID0gKCkgPT4gewogICAgICBpZiAoZGF0YS5yZXN1bHQubGVuZ3RoICE9PSBzdG9yZS5zdGF0ZS5jYXJ0TGlzdC5sZW5ndGgpIHsKICAgICAgICBpbml0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YS5yZXN1bHQgPSBbXTsKICAgICAgfQogICAgfTsgLy91cGRhdGUgZGF0YQoKCiAgICBjb25zdCB1cGRhdGUgPSB0eXBlID0+IHsKICAgICAgcmV0dXJuIHN0b3JlLnN0YXRlLmNhcnRMaXN0LmZpbHRlcihpdGVtID0+IHsKICAgICAgICByZXR1cm4gdHlwZSA9PT0gMiA/IGRhdGEucmVzdWx0LmluY2x1ZGVzKGl0ZW0uaWQpIDogIWRhdGEucmVzdWx0LmluY2x1ZGVzKGl0ZW0uaWQpOwogICAgICB9KTsKICAgIH07IC8vY2hlY2tvdXQKCgogICAgY29uc3Qgb25TdWJtaXQgPSAoKSA9PiB7CiAgICAgIGlmIChkYXRhLnJlc3VsdC5sZW5ndGggIT09IDApIHsKICAgICAgICBzdG9yZS5jb21taXQoJ1BBWScsIHVwZGF0ZSgyKSk7CiAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgcGF0aDogJy4vY3JlYXRlb3JkZXInLAogICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgbGlzdDogZGF0YS5yZXN1bHQKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBUb2FzdC5mYWlsKCdQbGVhc2Ugc2VsZWN0IGl0ZW1zIHRvIGNoZWNrb3V0Jyk7CiAgICAgIH0KICAgIH07IC8vZXZlcnkgc2VsZWN0IHRyaWdnZXIKCgogICAgY29uc3QgZ3JvdXBDaGFuZ2UgPSByZXN1bHQgPT4gewogICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gc3RvcmUuc3RhdGUuY2FydExpc3QubGVuZ3RoKSB7CiAgICAgICAgZGF0YS5jaGVja2VkID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkYXRhLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgZGF0YS5yZXN1bHQgPSByZXN1bHQ7CiAgICB9OyAvL3ByaWNlIGluIHRvdGFsCgoKICAgIGNvbnN0IGFsbFByaWNlID0gY29tcHV0ZWQoKCkgPT4gewogICAgICBsZXQgY291bnRMaXN0ID0gdXBkYXRlKDIpOwogICAgICBsZXQgc3VtID0gMDsKICAgICAgY291bnRMaXN0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgc3VtICs9IGl0ZW0ubnVtICogaXRlbS5wcmljZTsKICAgICAgfSk7CiAgICAgIHJldHVybiBzdW07CiAgICB9KTsgLy9saXN0ZW4gZWRpdCBjbGljawoKICAgIGVtaXR0ZXIub24oJ2VkaXQnLCAoKSA9PiB7CiAgICAgIGRhdGEuaXNEZWxldGUgPSAhZGF0YS5pc0RlbGV0ZTsKICAgIH0pOyAvL2RlbGV0ZSBidXR0b24KCiAgICBjb25zdCBkZWxldGVDbGljayA9ICgpID0+IHsKICAgICAgaWYgKGRhdGEucmVzdWx0Lmxlbmd0aCkgewogICAgICAgIC8vdXBkYXRlIGNhcnQgZGF0YSBhZnRlciBkZWxldGUKICAgICAgICBzdG9yZS5jb21taXQoJ0RFTEVURScsIHVwZGF0ZSgxKSk7IC8vc2VsZWN0IGFmdGVyIGRlbGV0ZQoKICAgICAgICBkYXRhLnJlc3VsdCA9IFtdOyAvL2NhcnQgaXMgZW1wdHkKCiAgICAgICAgaWYgKHN0b3JlLnN0YXRlLmNhcnRMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgc3RvcmUuY29tbWl0KCdFRElUJywgJ2RlbGV0ZScpOwogICAgICAgICAgcHJvcHMuY2hhbmdlU2hvdygpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBUb2FzdC5mYWlsKCdQbGVhc2Ugc2VsZWN0Jyk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIHsgLi4udG9SZWZzKGRhdGEpLAogICAgICBzdG9yZSwKICAgICAgb25DaGFuZ2UsCiAgICAgIG9uU3VibWl0LAogICAgICBjaG9zZUFsbCwKICAgICAgZ3JvdXBDaGFuZ2UsCiAgICAgIGFsbFByaWNlLAogICAgICBkZWxldGVDbGljawogICAgfTsKICB9Cgp9Ow=="},{"version":3,"mappings":"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","names":["declareTypeAlias","onMounted","reactive","toRefs","computed","useStore","useRouter","CourseAdd","emitter","components","props","setup","store","router","data","result","checked","isDelete","init","state","cartList","map","item","id","onChange","value","detail","name","num","choseAll","length","update","type","filter","includes","onSubmit","commit","push","path","query","list","Toast","fail","groupChange","allPrice","countList","sum","forEach","price","on","deleteClick","changeShow"],"sourceRoot":"","sources":["/Users/renxianggao/Desktop/DrivingInstructorBook/driving_instructor_book/src/pages/myCart/components/CartDetails.vue"],"sourcesContent":["<template>\n  <div class=\"cartDetails\">\n    <!-- Goods List -->\n    <div class=\"content\">\n      <van-checkbox-group v-model=\"result\" @change=\"groupChange\">\n        <div v-for=\"(i, index) in store.state.cartList\">\n          <CourseAdd :item=\"i\" :showCheckbox=\"true\" :onChange=\"onChange\" />\n        </div>\n      </van-checkbox-group>\n    </div>\n    <!-- Settle bill -->\n    <van-submit-bar\n      :price=\"allPrice * 100\"\n      button-text=\"Checkout\"\n      @submit=\"onSubmit\"\n      class=\"submit-all\"\n      button-color=\"#ffc400\"\n      currency=\"$\"\n      v-if=\"isDelete\"\n    >\n      <van-checkbox v-model=\"checked\" checked-color=\"#ffc400\" @click=\"choseAll\"\n        >All</van-checkbox\n      >\n    </van-submit-bar>\n\n    <!-- delete -->\n    <div class=\"buy\" v-else>\n      <div class=\"left\">\n        <van-checkbox\n          v-model=\"checked\"\n          checked-color=\"#ffc400\"\n          @click=\"choseAll\"\n          >All</van-checkbox\n        >\n      </div>\n      <div class=\"delete\" @click=\"deleteClick\">Delete</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { declareTypeAlias } from '@babel/types';\nimport { onMounted, reactive, toRefs, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport CourseAdd from '../../../components/CourseAdd.vue';\nimport emitter from '../../../common/js/eventbus.js';\n\nexport default {\n  components: { CourseAdd },\n  props: ['changeShow'],\n  setup(props) {\n    const store = useStore();\n    const router = useRouter();\n    let data = reactive({\n      result: [],\n      checked: true,\n      isDelete: true,\n    });\n\n    //goods default selection initialization\n    const init = () => {\n      data.result = store.state.cartList.map((item) => item.id);\n    };\n\n    onMounted(() => {\n      init();\n    });\n\n    //goods number sycchronization\n    const onChange = (value, detail) => {\n      store.state.cartList.map((item) => {\n        if (item.id === detail.name) {\n          item.num = value;\n        }\n      });\n    };\n\n    //select all and unselect all\n    const choseAll = () => {\n      if (data.result.length !== store.state.cartList.length) {\n        init();\n      } else {\n        data.result = [];\n      }\n    };\n\n    //update data\n    const update = (type) => {\n      return store.state.cartList.filter((item) => {\n        return type === 2\n          ? data.result.includes(item.id)\n          : !data.result.includes(item.id);\n      });\n    };\n\n    //checkout\n    const onSubmit = () => {\n      if (data.result.length !== 0) {\n        store.commit('PAY', update(2));\n        router.push({\n          path: './createorder',\n          query: {\n            list: data.result,\n          },\n        });\n      } else {\n        Toast.fail('Please select items to checkout');\n      }\n    };\n\n    //every select trigger\n    const groupChange = (result) => {\n      if (result.length === store.state.cartList.length) {\n        data.checked = true;\n      } else {\n        data.checked = false;\n      }\n      data.result = result;\n    };\n\n    //price in total\n    const allPrice = computed(() => {\n      let countList = update(2);\n      let sum = 0;\n      countList.forEach((item) => {\n        sum += item.num * item.price;\n      });\n      return sum;\n    });\n\n    //listen edit click\n    emitter.on('edit', () => {\n      data.isDelete = !data.isDelete;\n    });\n\n    //delete button\n    const deleteClick = () => {\n      if (data.result.length) {\n        //update cart data after delete\n        store.commit('DELETE', update(1));\n\n        //select after delete\n        data.result = [];\n\n        //cart is empty\n        if (store.state.cartList.length === 0) {\n          store.commit('EDIT', 'delete');\n          props.changeShow();\n        }\n      } else {\n        Toast.fail('Please select');\n      }\n    };\n\n    return {\n      ...toRefs(data),\n      store,\n      onChange,\n      onSubmit,\n      choseAll,\n      groupChange,\n      allPrice,\n      deleteClick,\n    };\n  },\n};\n</script>\n<style lang=\"less\" scoped>\n/deep/ .van-button--normal {\n  font-size: 10px;\n}\n/deep/ .van-submit-bar__bar {\n  font-size: 8px;\n  padding: 5px;\n}\n\n.cartDetails {\n  font-size: 14px;\n  flex: 1;\n  position: relative;\n  overflow-y: auto;\n  padding: 10px 10px 55px;\n  .submit-all {\n    position: fixed;\n    bottom: 20px;\n  }\n\n  .buy {\n    position: fixed;\n    bottom: 20px;\n    right: 0;\n    display: flex;\n    justify-content: space-between;\n    width: 100%;\n    background-color: #fff;\n    border-radius: 5px;\n    height: 25px;\n    align-items: center;\n    padding: 0 16px;\n    box-sizing: border-box;\n    .left {\n      display: flex;\n      align-items: center;\n    }\n    .delete {\n      color: #fff;\n      background-color: #ffc400;\n      border-radius: 20px;\n      font-size: 10px;\n      font-weight: 500;\n      width: 50px;\n      height: 20px;\n      text-align: center;\n      line-height: 20px;\n    }\n  }\n\n  .content {\n    padding: 10px;\n    background-color: #fff;\n    border-radius: 10px;\n  }\n}\n</style>\n<style>\n:root {\n  --van-checkbox-size: 8px;\n  --van-action-bar-icon-size: 13px;\n  --van-submit-bar-height: 15px;\n  --van-submit-bar-button-width: 55px;\n  --van-submit-bar-price-font-size: 8px;\n  --van-submit-bar-price-integer-font-size: 8px;\n  --van-submit-bar-text-font-size: 10px;\n  --van-submit-bar-tip-font-size: 10px;\n  --van-submit-bar-tip-icon-size: 6px;\n  --van-submit-bar-button-height: 20px;\n}\n</style>\n"]}]}